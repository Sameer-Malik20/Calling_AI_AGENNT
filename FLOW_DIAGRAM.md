# ğŸ”„ Demo Booking System - Flow Diagram

## Complete Flow: User Call â†’ Appointment â†’ Email

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        1. INCOMING CALL                              â”‚
â”‚                                                                       â”‚
â”‚  User Calls â†’ FreeSWITCH â†’ Handler detects call                     â”‚
â”‚  Phone: +1-212-555-0100                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    2. TIMEZONE DETECTION                             â”‚
â”‚                                                                       â”‚
â”‚  google-libphonenumber.parse("+1-212-555-0100")                     â”‚
â”‚  â†’ Country: US                                                       â”‚
â”‚  â†’ Area Code: 212                                                    â”‚
â”‚  â†’ Timezone: America/New_York (EST/EDT)                             â”‚
â”‚  â†’ Current User Time: 10:30 PM                                       â”‚
â”‚  â†’ Greeting: "Hello" (late night)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    3. AI CONVERSATION                                â”‚
â”‚                                                                       â”‚
â”‚  AI: "Hello! This is Sam from SusaLabs..."                          â”‚
â”‚  User: "Can we schedule a demo?"                                     â”‚
â”‚  AI: "Absolutely! What time works best for you?"                     â”‚
â”‚  User: "How about 2 PM tomorrow?"                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                4. AVAILABILITY CHECKING                              â”‚
â”‚                                                                       â”‚
â”‚  LLM calls: campaignManager.getBookedSlots()                        â”‚
â”‚  Returns: [                                                          â”‚
â”‚    { istTime: "2024-01-15T08:30:00Z", leadName: "John" },          â”‚
â”‚    { istTime: "2024-01-15T14:00:00Z", leadName: "Sarah" }          â”‚
â”‚  ]                                                                   â”‚
â”‚                                                                       â”‚
â”‚  User Request: 2 PM EST â†’ Converts to IST: 12:30 AM (next day)     â”‚
â”‚  Check: Is 12:30 AM between 9 AM - 9 PM IST? âŒ NO                  â”‚
â”‚  AI: "I'd love to, but our team is only available 9 AM - 9 PM      â”‚
â”‚       India time. Could we do 10 AM your time instead?"             â”‚
â”‚                                                                       â”‚
â”‚  User: "Sure, 10 AM works"                                           â”‚
â”‚  10 AM EST â†’ 8:30 PM IST âœ… Valid!                                  â”‚
â”‚  Check conflicts: No booking at 8:30 PM âœ… Available!               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    5. BOOKING TAG GENERATION                         â”‚
â”‚                                                                       â”‚
â”‚  AI Response: "Perfect! I've scheduled your demo for 10 AM your     â”‚
â”‚                time. You'll receive a confirmation shortly."         â”‚
â”‚                                                                       â”‚
â”‚  [BOOK_DEMO: {                                                       â”‚
â”‚    "user_time": "10:00 AM EST",                                     â”‚
â”‚    "ist_time": "2024-01-15T20:30:00.000Z",                          â”‚
â”‚    "timezone": "America/New_York"                                    â”‚
â”‚  }]                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    6. CALL HANGUP EVENT                              â”‚
â”‚                                                                       â”‚
â”‚  FreeSWITCH: CHANNEL_HANGUP_COMPLETE                                â”‚
â”‚  Handler: Detects [BOOK_DEMO] tag in conversation history           â”‚
â”‚  Extracts: { user_time, ist_time, timezone }                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    7. DATABASE OPERATIONS                            â”‚
â”‚                                                                       â”‚
â”‚  Step 1: Create CallLog                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ CallLog.create({                                          â”‚      â”‚
â”‚  â”‚   numberId: "507f...",                                    â”‚      â”‚
â”‚  â”‚   call_id: "uuid-1234",                                   â”‚      â”‚
â”‚  â”‚   transcript: "user: Can we...\nai: Absolutely...",       â”‚      â”‚
â”‚  â”‚   outcome: "DEMO_BOOKED",                                 â”‚      â”‚
â”‚  â”‚   appointment: {                                          â”‚      â”‚
â”‚  â”‚     user_time: "10:00 AM EST",                            â”‚      â”‚
â”‚  â”‚     ist_time: Date("2024-01-15T20:30:00Z"),              â”‚      â”‚
â”‚  â”‚     email: "user@example.com"                             â”‚      â”‚
â”‚  â”‚   }                                                        â”‚      â”‚
â”‚  â”‚ })                                                         â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                       â”‚
â”‚  Step 2: Create Appointment                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Appointment.create({                                      â”‚      â”‚
â”‚  â”‚   leadId: "507f...",                                      â”‚      â”‚
â”‚  â”‚   callLogId: callLog._id,                                 â”‚      â”‚
â”‚  â”‚   userTime: "10:00 AM EST",                               â”‚      â”‚
â”‚  â”‚   istTime: Date("2024-01-15T20:30:00Z"),                 â”‚      â”‚
â”‚  â”‚   timezone: "America/New_York",                           â”‚      â”‚
â”‚  â”‚   email: "user@example.com",                              â”‚      â”‚
â”‚  â”‚   status: "SCHEDULED",                                    â”‚      â”‚
â”‚  â”‚   notes: "Auto-booked via AI call on..."                 â”‚      â”‚
â”‚  â”‚ })                                                         â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    8. EMAIL GENERATION                               â”‚
â”‚                                                                       â”‚
â”‚  sendDemoConfirmationEmail(                                          â”‚
â”‚    email: "user@example.com",                                        â”‚
â”‚    name: "John Doe",                                                 â”‚
â”‚    userTime: "10:00 AM EST",                                         â”‚
â”‚    istTime: "2024-01-15T20:30:00Z",                                 â”‚
â”‚    timezone: "America/New_York"                                      â”‚
â”‚  )                                                                   â”‚
â”‚                                                                       â”‚
â”‚  Generates:                                                          â”‚
â”‚  1. Professional HTML Email                                          â”‚
â”‚  2. iCal Calendar Invite (.ics file)                                â”‚
â”‚  3. Sends via Nodemailer                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    9. USER RECEIVES EMAIL                            â”‚
â”‚                                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  From: SusaLabs Team <support@susalabs.com>            â”‚         â”‚
â”‚  â”‚  Subject: âœ“ Demo Confirmed: 10:00 AM EST - SusaLabs   â”‚         â”‚
â”‚  â”‚                                                         â”‚         â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚         â”‚
â”‚  â”‚  â”‚  âœ“ Demo Confirmed!                            â”‚     â”‚         â”‚
â”‚  â”‚  â”‚  SusaLabs Product Demonstration               â”‚     â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚         â”‚
â”‚  â”‚                                                         â”‚         â”‚
â”‚  â”‚  Hi John Doe,                                           â”‚         â”‚
â”‚  â”‚                                                         â”‚         â”‚
â”‚  â”‚  Great news! Your demo session has been scheduled.     â”‚         â”‚
â”‚  â”‚                                                         â”‚         â”‚
â”‚  â”‚  ğŸ“… Scheduled Time                                     â”‚         â”‚
â”‚  â”‚  Your Local Time: 10:00 AM EST                         â”‚         â”‚
â”‚  â”‚  Timezone: America/New_York                            â”‚         â”‚
â”‚  â”‚                                                         â”‚         â”‚
â”‚  â”‚  India Standard Time (IST)                             â”‚         â”‚
â”‚  â”‚  Monday, January 15, 2024, 08:30 PM                    â”‚         â”‚
â”‚  â”‚                                                         â”‚         â”‚
â”‚  â”‚  [Add to Calendar] â† iCal attachment                   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    10. TEAM NOTIFICATION                             â”‚
â”‚                                                                       â”‚
â”‚  sendTeamNotificationEmail({                                         â”‚
â”‚    leadName: "John Doe",                                             â”‚
â”‚    email: "user@example.com",                                        â”‚
â”‚    phone: "+1-212-555-0100",                                         â”‚
â”‚    userTime: "10:00 AM EST",                                         â”‚
â”‚    istTime: "2024-01-15T20:30:00Z",                                 â”‚
â”‚    timezone: "America/New_York"                                      â”‚
â”‚  })                                                                  â”‚
â”‚                                                                       â”‚
â”‚  Team receives:                                                      â”‚
â”‚  "ğŸ¯ New Demo Booked: John Doe"                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    11. FRONTEND CALENDAR UPDATE                      â”‚
â”‚                                                                       â”‚
â”‚  User navigates to: /appointments                                    â”‚
â”‚                                                                       â”‚
â”‚  API Call: GET /api/appointments?startDate=...&endDate=...          â”‚
â”‚                                                                       â”‚
â”‚  Calendar renders:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚        January 2024                                  â”‚            â”‚
â”‚  â”‚  Sun  Mon  Tue  Wed  Thu  Fri  Sat                  â”‚            â”‚
â”‚  â”‚   -    1    2    3    4    5    6                   â”‚            â”‚
â”‚  â”‚   7    8    9   10   11   12   13                   â”‚            â”‚
â”‚  â”‚  14  [15]  16   17   18   19   20  â† Blue highlight â”‚            â”‚
â”‚  â”‚  21   22   23   24   25   26   27                   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                       â”‚
â”‚  Click on 15 â†’ Modal opens with:                                    â”‚
â”‚  - Lead: John Doe                                                    â”‚
â”‚  - Time: 10:00 AM EST (8:30 PM IST)                                 â”‚
â”‚  - Call Transcript                                                   â”‚
â”‚  - [Schedule Follow-up] [Mark Complete] [Cancel]                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Summary

```
Phone Number â†’ Timezone Detection â†’ AI Context
                                        â†“
                            Availability Checking
                                        â†“
                            Time Conversion & Validation
                                        â†“
                            Booking Tag Generation
                                        â†“
                            Database Storage
                                        â†“
                    Email (User) + Notification (Team)
                                        â†“
                            Frontend Calendar Display
```

---

## Key Decision Points

### 1. Timezone Detection
```
Input: +1-212-555-0100
  â†“
Parse country code: +1 (US)
  â†“
Extract area code: 212
  â†“
Lookup mapping: 212 â†’ America/New_York
  â†“
Output: EST/EDT timezone
```

### 2. Availability Check
```
User requests: 2 PM EST
  â†“
Convert to IST: 12:30 AM IST (next day)
  â†“
Check business hours: 9 AM - 9 PM IST?
  â†“
12:30 AM âˆ‰ [9 AM, 9 PM] â†’ âŒ Invalid
  â†“
Suggest alternative: "Could we do 10 AM your time?"
```

### 3. Conflict Detection
```
User requests: 10 AM EST
  â†“
Convert to IST: 8:30 PM IST
  â†“
Fetch booked slots from DB
  â†“
Check 15-minute window:
  - 8:15 PM to 8:45 PM
  â†“
Any booking in this range? â†’ âŒ No
  â†“
âœ… Slot available, proceed with booking
```

---

## Component Interaction

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FreeSWITCH  â”‚ â† Handles call
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LLM Wrapper  â”‚ â† Timezone logic, availability check
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Manager    â”‚ â† Database operations
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Email Service â”‚ â† Send emails with calendar
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend   â”‚ â† Display in calendar
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Error Handling Flow

```
Timezone Detection Fails
  â†“
Fallback to IST (Asia/Kolkata)
  â†“
Continue with booking

Email Sending Fails
  â†“
Log error
  â†“
Appointment still created
  â†“
Team can manually send email

Database Save Fails
  â†“
Rollback transaction
  â†“
Return error to AI
  â†“
AI informs user: "Sorry, technical issue. Please try again."
```

---

This flow ensures:
- âœ… **Zero manual intervention** required
- âœ… **Automatic timezone handling** for global users
- âœ… **Conflict prevention** with real-time checking
- âœ… **Professional communication** via emails
- âœ… **Full visibility** on frontend calendar
